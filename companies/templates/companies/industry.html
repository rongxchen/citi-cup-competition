<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="utf-8">
    <title>Industry</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Bolo is creative one page website template">
    <meta name="author" content="">

    <!--[if lt IE 9]>
    <script src="../../../static/js/html5shiv.js"></script>
    <![endif]-->

    <!-- CSS Files
    ================================================== -->
    <link rel="stylesheet" href="../../../static/css/bootstrap.min.css" type="text/css">
	<link rel="stylesheet" href="../../../static/css/bootstrap-grid.min.css" type="text/css">
	<link rel="stylesheet" href="../../../static/css/bootstrap-reboot.min.css" type="text/css">
    <link rel="stylesheet" href="../../../static/css/animate.css" type="text/css">
    <link rel="stylesheet" href="../../../static/css/owl.carousel.css" type="text/css">
    <link rel="stylesheet" href="../../../static/css/owl.theme.css" type="text/css">
    <link rel="stylesheet" href="../../../static/css/owl.transitions.css" type="text/css">
    <link rel="stylesheet" href="../../../static/css/magnific-popup.css" type="text/css">
    <link rel="stylesheet" href="../../../static/css/jquery.countdown.css" type="text/css">
    <link rel="stylesheet" href="../../../static/css/style.css" type="text/css">
    <link rel="stylesheet" href="../../../static/css/colors/red.css" type="text/css">

    <!--vue and element js-->
    <!--NOTE: vue.js should be imported before element.js-->
    <script src="../../../static/js/vue.js" type="text/javascript" charset="utf-8"></script>

    <!--axios-->
    <script src="../../../static/js/axios.js" type="text/javascript" charset="utf-8"></script>

    <!-- 引入样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- 引入组件库 -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>

    <style>
        /*for cards*/
        .cardList {
            display: flex;
            flex-wrap: wrap;
        }
        .cardList .el-card {
            height: 280px;
        }
        .card {
            overflow-y: scroll;
        }
    </style>
</head>

<body>
    <div id="app">
    <div id="wrapper">

        <div class="page-overlay">
            <div class="preloader-wrap">
                <div class="spinner">
                    <div class="bounce1"></div>
                    <div class="bounce2"></div>
                    <div class="bounce3"></div>
                </div>
            </div>
        </div>

        <!-- header begin -->
        <header>

            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <!-- logo begin -->
                        <div id="logo">
                            <a href="index.html">
<!--                                <img class="logo" src="../../../static/images/logo-light.png" alt="">-->
<!--                                <img class="logo-2" src="../../../static/images/logo-dark.png" alt="">-->
                                <img class="logo" width="100px" height="50px" src="../../../static/images/logo2.png">
                                <img class="logo-2" width="100px" height="50px" src="../../../static/images/logo2.png">
                            </a>
                        </div>
                        <!-- logo close -->

                        <!-- small button begin -->
                        <span id="menu-btn"></span>
                        <!-- small button close -->

                        <!-- mainmenu begin -->
                        <nav>
                            <ul id="mainmenu">
                                <li><a href="index.html">Home</a></li>
                                <li><a href="news.html">News</a></li>
                                <li><a href="industry.html">Industry</a></li>
                                <li><a href="https://epiphany-citi.my.canva.site/" target="_blank">Demo</a></li>
                            </ul>
                        </nav>
						<!-- mainmenu close -->

                    </div>

                </div>
            </div>
        </header>
        <!-- header close -->

        <!-- content begin -->
        <h3 id="content" class="no-bottom no-top">
            <div id="top"></div>

            <!-- section begin -->
            <section id="section-intro" class="full-height relative owl-slide-wrapper text-light no-top no-bottom" data-bgimage="url(static/images/background/esg_industry_page.jpg)" data-stellar-background-ratio=".2">
                <div class="overlay-bg t50">

                    <div class="center-y relative">
                        <div class="container">
                            <div class="row">
                                <div class="col-md-8">
                                    <div class="spacer-double d-block d-sm-none d-md-block"></div>
                                    <h2 class="big b">E (Environment), <br>S (Social) &amp;<br>G (Governance)</h2>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </section>
            <!-- section close -->

            <el-container>
                <el-aside width="50px"></el-aside>

                <el-main>
                    <!-- section begin -->
                    <section data-bgcolor="#f9f9f9" style="padding-top: 40px">
                        <div class="container">
                            <div align="center" style="padding-left: 10px; padding-right: 0">
                                <img width="400px" height="300px" src="../../../static/images/background/msci_industry_page.jpg" alt="">
                            </div>

                            <br><br>
                            <div style="padding-left: 70px; padding-right: 70px; padding-top:10px" align="center">
                                <h3 align="center" class="mb20">MSCI ESG Standard</h3>
                                <p style="font-size: 14px">MSCI ESG标准是全球领先的金融指数提供商MSCI开发的环境、社会和治理（ESG）标准，旨在帮助投资者和企业评估和管理ESG风险和机会，实现长期的可持续性和财务绩效。</p>
                                <a href="https://www.msci.com/zh/esg-ratings" target="_blank" class="btn-custom scroll-to">Click for more details</a>
                            </div>
                        </div>
                    </section>
                    <!-- section close -->
                </el-main>

                <el-aside width="450px">
                    <br>
                    <h3>请选择行业/子行业</h3>
                    <!-- sector selector -->

                    <template>
                        <el-select v-model="sectorSelected" filterable placeholder="行业" @change="handleSectorSelectorChange">
                            <el-option
                              v-for="item in sectorList"
                              :key="item.name"
                              :label="item.name"
                              :value="item.sector_id">
                            </el-option>
                        </el-select>

                        <el-select
                            v-model="subsectorSelected"
                            style="margin-left: 20px;"
                            filterable placeholder="子行业"
                            @change="handleSubsectorSelectorChange">
                            <el-option
                              v-for="item in specificSubsectorList"
                              :key="item.name"
                              :label="item.name"
                              :value="item.id">
                            </el-option>
                        </el-select>
                    </template>

                    <el-table
                        :data="sectorScoreTable"
                        style="width: 100%"
                        height="540">
                        <el-table-column
                            prop="category"
                            label="类别"
                            width="110px">
                            <template slot-scope="scope">
                                <div v-text="scope.row.category"></div>
                            </template>
                        </el-table-column>

                        <el-table-column
                            label="详细权重">
                            <template slot-scope="scope">
                                <div v-for="(item) of (scope.row.scores)">
<!--                                    <li v-text="(item.issue)+': '+(item.score)"></li>-->
                                    <div v-text="(item.issue)+': '"></div>
                                    <el-progress :percentage="(item.score)" :color="(scope.row.color)"></el-progress>
                                </div>
                            </template>
                        </el-table-column>

                    </el-table>

                    <!-- sector selector end -->
                </el-aside>

                <el-aside width="50px"></el-aside>
            </el-container>

            <div v-for="i in 3">
                <br>
            </div>

            <el-container style="padding-top: 0">
                <el-aside width="50px"></el-aside>

                <el-main>
                    <!-- industry score -->
                    <template>

                        <h2 style="font-size: 22px" align="center">ESG权重（随机版块）</h2>
                        <el-row :gutter="20" v-for="i in 4" :key="i" class="cardList" style="padding-bottom: 30px">
                            <el-col v-for="(sector, index) in randomSubsectorList.slice(i*3, (i+1)*3)" :key="index" :span="8">
                                <el-card class="card" style="width: 320px; height: 400px">
                                    <h3 style="font-size: 20px" align="center" v-text="sector.name"></h3>
                                    <div>
                                        <el-collapse v-model="activityName" @change="handleCollapseChange">
                                            <el-collapse-item :title="'environment ('+sector.scores.environment.length+')'" :name="(sector.name)+'_environment'">
                                                <div>
                                                    <div style="font-size: 14px" v-if="sector.scores.environment.length === 0">No data</div>
                                                    <div v-for="(item, i2) in sector.scores.environment" :key="i2">
                                                        <div v-for="(v, k, i) in item">
                                                            <div style="font-size: 14px" v-text="(k)+': '"></div>
                                                            <el-progress :percentage="(v)" color="green"></el-progress>
                                                        </div>
                                                    </div>
                                                </div>
                                            </el-collapse-item>

                                            <el-collapse-item :title="'social ('+sector.scores.social.length+')'" :name="(sector.name)+'_social'">
                                                <div>
                                                    <div style="font-size: 14px" v-if="sector.scores.social.length === 0">No data</div>
                                                    <div v-for="(item, i2) in sector.scores.social" :key="i2">
                                                        <div v-for="(v, k, i) in item">
                                                            <div style="font-size: 14px" v-text="(k)+': '"></div>
                                                            <el-progress :percentage="(v)" color="blue"></el-progress>
                                                        </div>
                                                    </div>
                                                </div>
                                            </el-collapse-item>

                                            <el-collapse-item :title="'governance ('+sector.scores.governance.length+')'" :name="(sector.name)+'_governance'">
                                                <div>
                                                    <div style="font-size: 14px" v-if="sector.scores.governance.length === 0">No data</div>
                                                    <div v-for="(item, i2) in sector.scores.governance" :key="i2">
                                                        <div v-for="(v, k, i) in item">
                                                            <div style="font-size: 14px" v-text="(k)+': '"></div>
                                                            <el-progress :percentage="(v)" color="red"></el-progress>
                                                        </div>
                                                    </div>
                                                </div>
                                            </el-collapse-item>

                                        </el-collapse>
                                    </div>
                                </el-descriptions>
                                </el-card>
                            </el-col>
                        </el-row>

                    </template>
                    <!-- industry score end -->
                </el-main>

                <el-aside width="50px"></el-aside>
            </el-container>
        </h3>
    </div>
            <!-- content close -->

            <div v-for="i in 3">
                <br>
            </div>

            <el-container>
                <el-aside width="50px"></el-aside>

                <el-main>
                    <!-- crawler source -->
                    <h3 align="center" style="font-size: 12px; background-color: white">以上数据爬取自:
                        <a href="https://www.msci.com/our-solutions/esg-investing/esg-industry-materiality-map" target="_blank">MSCI ESG</a>
                    </h3>
                    <!-- crawler source end -->
                </el-main>

                <el-aside width="50px"></el-aside>
            </el-container>

            <a href="#" id="back-to-top"></a>

            <div id="preloader">
                <div class="preloader1"></div>
            </div>

        </div>
    </div>
        <!-- Javascript Files
    ================================================== -->
        <script src="../../../static/js/jquery.min.js"></script>
        <script src="../../../static/js/bootstrap.min.js"></script>
        <script src="../../../static/js/jquery.isotope.min.js"></script>
        <script src="../../../static/js/easing.js"></script>
        <script src="../../../static/js/owl.carousel.js"></script>
        <script src="../../../static/js/jquery.countTo.js"></script>
        <script src="../../../static/js/wow.min.js"></script>
        <script src="../../../static/js/jquery.magnific-popup.min.js"></script>
        <script src="../../../static/js/enquire.min.js"></script>
        <script src="../../../static/js/jquery.stellar.min.js"></script>
        <script src="../../../static/js/jquery.plugin.js"></script>
		<script src="../../../static/js/jquery.easeScroll.js"></script>
        <script src="../../../static/js/designesia.js"></script>
        <script src="../../../static/js/validation.js"></script>
</body>

<script src="../../../static/js/config/encap.js"></script>

<script>
    const vue = new Vue({
        el: "#app",
        data() {
            return {
                sectorList: [],
                randomSubsectorList: [],
                activityName: [],
                sectorSelected: "",
                specificSubsectorList: [],
                subsectorSelected: "",
                sectorScoreTable: [],
            }
        },
        methods: {
            handleCollapseChange(key) {
                console.log(key);
            },
            handleSectorSelectorChange(val) {
                this.sectorScoreTable = [];
                this.specificSubsectorList = [];
                this.subsectorSelected = "";
                this.sectorSelected = val;
                for (item of this.sectorList) {
                    if (item.sector_id === this.sectorSelected) {
                        for (cate in item.scores) {
                            const scores = [];
                            for (issue of item.scores[cate]) {
                                for (k in issue) {
                                    scores.push({"issue": k, "score": issue[k]});
                                }
                            }
                            var color = cate === "environment"? "green": (cate === "social"? "blue": "red");
                            this.sectorScoreTable.push({"category": cate, "scores": scores, "color": color});
                        }
                        console.log(this.sectorScoreTable);
                        for (i2 of item.subsectors) {
                            this.specificSubsectorList.push({"name": i2.name, "id": i2.subsector_id});
                        }
                        break;
                    }
                }
            },
            handleSubsectorSelectorChange(val) {
                this.sectorScoreTable = [];
                this.subsectorSelected = val;
                url = `/companies/report/score/subsector/${this.subsectorSelected}`;
                myAxios("get", url).then((res) => {
                    var data = res.data.data;
                    for (item in data) {
                        const scores = []
                        for (issue of data[item]) {
                            for (k in issue) {
                                scores.push({"issue": k, "score": issue[k]});
                            }
                        }
                        var color = item === "environment"? "green": (item === "social"? "blue": "red");
                        this.sectorScoreTable.push({"category": item, "scores": scores, "color": color});
                    }
                })
            },
            getSectorList() {
                var url = `/companies/report/score/sectorlist/`;
                myAxios("get", url).then((res) => {
                    this.sectorList = res.data.data;
                    for (var i = 0; i < this.sectorList.length; i++) {
                        const subsectors = this.sectorList[i].subsectors;
                        for (var j = 0; j < subsectors.length; j++) {
                            if (subsectors[j].scores.environment.length !== 0 && subsectors[j].scores.social.length !== 0 && subsectors[j].scores.governance.length !== 0) {
                                this.randomSubsectorList.push(subsectors[j]);
                                const temp = [subsectors[j].name + "_environment", subsectors[j].name + "_social", subsectors[j].name + "_governance"];
                                this.activityName.push(temp[Math.floor(Math.random()*3)]);
                            }
                        }
                    }
                    console.log(this.activityName);
                    this.randomSubsectorList.sort(() => 0.5 - Math.random());
                })
            },
        },
        mounted() {
            this.getSectorList();
        }
    })
</script>

</html>